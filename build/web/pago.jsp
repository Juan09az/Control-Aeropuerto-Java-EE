<%-- Document : pago Created on : 1/11/2020, 11:34:05 PM Author : cesit --%><%@page import="java.text.SimpleDateFormat"%> <%@page import="entities.Usuario"%> <%@page import="java.sql.Time"%> <%@page import="java.util.Date"%> <%@page import="entities.Clase"%> <%@page import="java.util.List"%> <%@page import="ORMJPA.ORMaero"%> <%@page contentType="text/html" pageEncoding="UTF-8"%> <!DOCTYPE html><html> <% ORMaero objOrm; if (request.getParameter("registrarP")!=null) { objOrm = new ORMaero(); int cantidad=Integer.valueOf(request.getParameter("cantidad")); String nombre,apellido,id,email,telefono,direccion,sexo,idreserva; Date fechaNac; Usuario user=new Usuario(); String codVuelo=request.getParameter("codVuelo"); String idpasajero; String idPago=request.getParameter("idPago"); String clase=request.getParameter("clase"); SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd"); for(int i=1;i<=cantidad;i++){ nombre=request.getParameter(("nombreP")+i); apellido=request.getParameter(("apellidoP")+i); id=request.getParameter(("identificacionP")+i); email=request.getParameter(("correoP")+i); sexo=request.getParameter(("sexoP")+i); telefono=request.getParameter(("telefonoP")+i); direccion=request.getParameter(("direccionP")+i); fechaNac= sdf.parse(request.getParameter(("fechaNac")+i)); user.setUsuario(session.getAttribute("usuario").toString()); user.setTipo(session.getAttribute("tipo").toString()); idreserva=String.valueOf(codVuelo.charAt(0))+String.valueOf(codVuelo.charAt(1))+String.valueOf(id.charAt(0))+String.valueOf(id.charAt(1))+String.valueOf(id.charAt(2))+String.valueOf(codVuelo.charAt(2)); objOrm.realizarReserva(idreserva,idPago,codVuelo,clase,nombre, apellido, id, fechaNac, sexo, email, Integer.valueOf(telefono), direccion, user); } response.sendRedirect("Index.jsp"); } else { String codVuelo = request.getParameter("codVuelo"); String clase=request.getParameter("clase"); String usuario = request.getSession().getAttribute("usuario").toString(); String valor = request.getParameter("valor"); String nPasajeros = request.getParameter("cant"); String id = (String.valueOf(usuario.charAt(0) + usuario.charAt(1)) + (new Date()).toString().charAt(0) + (new Date()).toString().charAt(1) + (new Date()).toString().charAt(6) + (new Date()).getTime()); objOrm = new ORMaero(); java.sql.Date fecha = new java.sql.Date(new Date().getTime()); objOrm.registrarPago(id, fecha, Double.valueOf(valor)); String redir = "RegistroPasajeros.jsp?cant="+nPasajeros+"&idPago="+id+"&codVuelo="+codVuelo+"&clase="+clase; response.sendRedirect(redir); } %></html>